<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Hello</title>
        <script src="phaser.js"></script>
        <script src="user.js"></script>
        <script src="betapi.js"></script>
        <script src="server.js"></script>
        <script src="rectdrawer.js"></script>
        <script src="animations.js"></script>
        <script src="main.js"></script>

        <style type="text/css">
        body {
        	background-color: black;
            margin:0px;
        }

        #gamediv {
        	margin: 0 auto;
            position:absolute;
        	width: 100%;
            height: 100%;
            z-index:-1;
        }
        </style>
        
        <script>
            // startGame({ws_server:"172.24.222.54:8989"});
           
           /*
            */
        
             // Debug
             var PLAT = "__PLAT__";
             
             //var PLAT = "IOS";
             
             if(PLAT == "IOS") {
                 enableNativeLog();
             } else {
                 startGame({});
             }
        
        
        function enableNativeLog() {
             console = new Object();
             console.log = function(log, other) {
             var iframe = document.createElement("IFRAME");
             var otherstring = ""
             if(other != undefined) {
                 otherstring = other;
             }
             
             iframe.setAttribute("src", "ios-log:#iOS#" + log + ":", otherstring);
             document.documentElement.appendChild(iframe);
             iframe.parentNode.removeChild(iframe);
             iframe = null;
             };
             console.debug = console.log;
             console.info = console.log;
             console.warn = console.log;
             console.error = console.log;
             console.log("test log ===");
        }


        
        function connectWebViewJavascriptBridge(callback) {
                if (window.WebViewJavascriptBridge) {
                    callback(WebViewJavascriptBridge)
                } else {
                    document.addEventListener('WebViewJavascriptBridgeReady', function() {
                                              callback(WebViewJavascriptBridge)
                                              }, false)
                }
            }
        try {
        
        connectWebViewJavascriptBridge(function(bridge) {
                bridge.init(function(message, responseCallback) {
                               console.log("WebViewJavascriptBridge init OK");
                            });
                
                bridge.send("echo", function(response){
                                                   console.log("echo get response ===");

                                                   });
                bridge.callHandler("getNativeConfig",null,function(data){
                                            console.log(data.ws_server);
                                            startGame(data);
                                   });
            });
        }catch(e) {
            console.log(e);
        }

        </script>
    </head>
    <body>
    <div id="gamediv"></div>
    </body>
</html>